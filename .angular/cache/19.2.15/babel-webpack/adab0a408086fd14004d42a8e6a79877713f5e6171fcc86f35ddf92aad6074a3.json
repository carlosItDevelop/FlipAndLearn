{"ast":null,"code":"import { BehaviorSubject, Observable, of } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class LessonService {\n  constructor(http) {\n    this.http = http;\n    this.apiUrl = 'http://localhost:3001/api';\n    this.lessonsSubject = new BehaviorSubject([]);\n    this.lessons$ = this.lessonsSubject.asObservable();\n    this.currentFilterSubject = new BehaviorSubject('Todos');\n    this.currentFilter$ = this.currentFilterSubject.asObservable();\n    this.loadLessonsFromAPI();\n  }\n  loadLessonsFromAPI() {\n    this.http.get(`${this.apiUrl}/lessons`).pipe(map(lessons => lessons.map(lesson => ({\n      ...lesson,\n      englishText: lesson.english_text || lesson.englishText,\n      portugueseText: lesson.portuguese_text || lesson.portugueseText\n    }))), catchError(error => {\n      console.error('Failed to load lessons from API:', error);\n      return of([]);\n    })).subscribe(lessons => {\n      this.lessonsSubject.next(lessons);\n    });\n  }\n  getLessons() {\n    return this.lessons$;\n  }\n  getFilteredLessons(filter) {\n    return new Observable(observer => {\n      this.lessons$.subscribe(lessons => {\n        if (filter === 'Todos') {\n          observer.next(lessons);\n        } else {\n          observer.next(lessons.filter(lesson => lesson.level === filter));\n        }\n      });\n    });\n  }\n  addLesson(lesson) {\n    const userLessons = this.getUserLessons();\n    const newLesson = {\n      ...lesson,\n      id: Date.now() // Simple ID generation\n    };\n    userLessons.push(newLesson);\n    this.saveUserLessons(userLessons);\n    const allLessons = [...this.initialLessons, ...userLessons];\n    this.lessonsSubject.next(allLessons);\n  }\n  setFilter(filter) {\n    this.currentFilterSubject.next(filter);\n  }\n  getCurrentFilter() {\n    return this.currentFilterSubject.value;\n  }\n  static {\n    this.ɵfac = function LessonService_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || LessonService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: LessonService,\n      factory: LessonService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","Observable","of","catchError","map","LessonService","constructor","http","apiUrl","lessonsSubject","lessons$","asObservable","currentFilterSubject","currentFilter$","loadLessonsFromAPI","get","pipe","lessons","lesson","englishText","english_text","portugueseText","portuguese_text","error","console","subscribe","next","getLessons","getFilteredLessons","filter","observer","level","addLesson","userLessons","getUserLessons","newLesson","id","Date","now","push","saveUserLessons","allLessons","initialLessons","setFilter","getCurrentFilter","value","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["/home/runner/workspace/src/app/services/lesson.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { HttpClient } from '@angular/common/http';\nimport { catchError, map, tap } from 'rxjs/operators';\nimport { Lesson, LevelFilter } from '../models/lesson.model';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LessonService {\n  private apiUrl = 'http://localhost:3001/api';\n  private lessonsSubject = new BehaviorSubject<Lesson[]>([]);\n  public lessons$ = this.lessonsSubject.asObservable();\n\n  private currentFilterSubject = new BehaviorSubject<LevelFilter>('Todos');\n  public currentFilter$ = this.currentFilterSubject.asObservable();\n\n  constructor(private http: HttpClient) {\n    this.loadLessonsFromAPI();\n  }\n\n  private loadLessonsFromAPI(): void {\n    this.http.get<Lesson[]>(`${this.apiUrl}/lessons`)\n      .pipe(\n        map(lessons => lessons.map(lesson => ({\n          ...lesson,\n          englishText: lesson.english_text || lesson.englishText,\n          portugueseText: lesson.portuguese_text || lesson.portugueseText\n        } as Lesson))),\n        catchError(error => {\n          console.error('Failed to load lessons from API:', error);\n          return of([]);\n        })\n      )\n      .subscribe(lessons => {\n        this.lessonsSubject.next(lessons);\n      });\n  }\n\n  getLessons(): Observable<Lesson[]> {\n    return this.lessons$;\n  }\n\n  getFilteredLessons(filter: LevelFilter): Observable<Lesson[]> {\n    return new Observable(observer => {\n      this.lessons$.subscribe(lessons => {\n        if (filter === 'Todos') {\n          observer.next(lessons);\n        } else {\n          observer.next(lessons.filter(lesson => lesson.level === filter));\n        }\n      });\n    });\n  }\n\n  addLesson(lesson: Omit<Lesson, 'id'>): void {\n    const userLessons = this.getUserLessons();\n    const newLesson: Lesson = {\n      ...lesson,\n      id: Date.now() // Simple ID generation\n    };\n    \n    userLessons.push(newLesson);\n    this.saveUserLessons(userLessons);\n    \n    const allLessons = [...this.initialLessons, ...userLessons];\n    this.lessonsSubject.next(allLessons);\n  }\n\n  setFilter(filter: LevelFilter): void {\n    this.currentFilterSubject.next(filter);\n  }\n\n  getCurrentFilter(): LevelFilter {\n    return this.currentFilterSubject.value;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}